#Final version of this script to test for the trans_shell script. Uses Google Translate via Translate Shell. Splits text into chunks <2000 characters. Input is a hardcoded text string. Output is a single line of text.   

import subprocess
import re

# Configuration
translator = 'google'
target_lang = 'en'
MAX_CHUNK_SIZE = 2000

# Your text to translate
text_to_translate = '''Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.Экс-госсекретарь США Кондолиза Райс дала интервью для проекта Блестящие умы Стэнфорда и Кремниевой долины, опубликованном в украинском издании Новое время, в котором она изложила свою точку зрения на место Украины в глобальной политике    Фото со страницы Condoleezza Rice в twitter    Беседу провели замминистра экономразвития Украины Наталья Микольская и известный в западных кругах философ Фрэнсис Фукуяма.    О смене власти на Украине    Райс первым делом обратила внимание на то, что в стране впервые за долгое время состоялся мирный переход от одного президента к другому.    В Украине это случалось несколько раз, но также были и несколько революций. И я сказала своим украинским коллегам: уже пора начать управлять.    Она выразила надежду, что на Украине продолжится борьба с коррупцией, развитие экономики и просвещение граждан, которое, с ее точки зрения, длилось в последние годы.'''

def split_text_smart(text, max_size=MAX_CHUNK_SIZE):
    """Split text into chunks at natural breakpoints (sentences, paragraphs)"""
    if len(text) <= max_size:
        return [text]
    
    chunks = []
    current_chunk = ""
    
    # Split by paragraphs first (double spaces or newlines)
    paragraphs = re.split(r'\n\s*\n|\s{4,}', text)
    
    for paragraph in paragraphs:
        paragraph = paragraph.strip()
        if not paragraph:
            continue
            
        # If adding this paragraph would exceed limit
        if len(current_chunk) + len(paragraph) + 1 > max_size:  # +1 for space
            if current_chunk:
                chunks.append(current_chunk.strip())
                current_chunk = ""
            
            # If single paragraph is too long, split by sentences
            if len(paragraph) > max_size:
                sentences = re.split(r'(?<=[.!?])\s+', paragraph)
                temp_chunk = ""
                
                for sentence in sentences:
                    if len(temp_chunk) + len(sentence) + 1 > max_size:
                        if temp_chunk:
                            chunks.append(temp_chunk.strip())
                            temp_chunk = ""
                    
                    # If single sentence is still too long, force split
                    if len(sentence) > max_size:
                        while len(sentence) > max_size:
                            chunks.append(sentence[:max_size].strip())
                            sentence = sentence[max_size:]
                        if sentence.strip():
                            temp_chunk = sentence
                    else:
                        temp_chunk += (" " if temp_chunk else "") + sentence
                
                if temp_chunk.strip():
                    current_chunk = temp_chunk
            else:
                current_chunk = paragraph
        else:
            current_chunk += (" " if current_chunk else "") + paragraph
    
    if current_chunk.strip():
        chunks.append(current_chunk.strip())
    
    return chunks

def translate_text(text, translator, target_lang):
    """Translate a single chunk of text"""
    cmd = ['trans', f'--translators={translator}', '-b', f':{target_lang}', text]
    result = subprocess.run(cmd, capture_output=True, text=True)

    if result.returncode != 0:
        raise RuntimeError(f"[{translator}] Translate Shell error: {result.stderr.strip()}")

    # Remove any line breaks from the translation result
    return result.stdout.strip().replace('\n', ' ').replace('\r', ' ')

def translate_with_chunking(text, translator, target_lang):
    """Translate text, splitting into chunks if necessary"""
    print(f"Text length: {len(text)} characters")
    
    if len(text) <= MAX_CHUNK_SIZE:
        print("Translating as single chunk...")
        return translate_text(text, translator, target_lang)
    
    # Split into chunks
    chunks = split_text_smart(text, MAX_CHUNK_SIZE)
    print(f"Split into {len(chunks)} chunks")
    
    translated_chunks = []
    for i, chunk in enumerate(chunks, 1):
        print(f"Translating chunk {i}/{len(chunks)} ({len(chunk)} chars)...")
        try:
            translated_chunk = translate_text(chunk, translator, target_lang)
            translated_chunks.append(translated_chunk)
        except RuntimeError as e:
            print(f"Error translating chunk {i}: {e}")
            translated_chunks.append(f"[TRANSLATION FAILED FOR CHUNK {i}]")
    
    # Concatenate all translated chunks with spaces (no line breaks)
    return " ".join(translated_chunks)

def main():
    print("=== ORIGINAL TEXT ===")
    print(text_to_translate)
    print("\n" + "="*50 + "\n")
    
    print("=== TRANSLATION ===")
    try:
        translated_text = translate_with_chunking(text_to_translate, translator, target_lang)
        print(translated_text)
    except Exception as e:
        print(f"Translation failed: {e}")

if __name__ == '__main__':
    main()
